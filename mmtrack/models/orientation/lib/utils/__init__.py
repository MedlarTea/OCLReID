from .utils import restrain_upper_bound